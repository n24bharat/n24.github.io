<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>N24.in â€“ Independent Hindi News & Videos</title>

<style>
body {
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
  background: #f3f4f6;
  color: #111827;
}
header {
  background: #fff;
  border-bottom: 3px solid #b91c1c;
  padding: 12px 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  z-index: 20;
}
.logo {
  font-weight: 800;
  color: #b91c1c;
  font-size: 1.1rem;
}
main {
  max-width: 1000px;
  margin: auto;
  padding: 16px;
}
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 16px;
}
.card {
  background: #fff;
  border-radius: 10px;
  overflow: hidden;
  border: 1px solid #e5e7eb;
}
.thumb img {
  width: 100%;
  height: 180px;
  object-fit: cover;
  background: #000;
}
.content {
  padding: 12px;
}
.source {
  font-size: 0.75rem;
  font-weight: 700;
  color: #6b7280;
}
.title {
  font-size: 1rem;
  font-weight: 700;
  margin: 6px 0;
}
.desc {
  font-size: 0.9rem;
  color: #374151;
}
.meta {
  font-size: 0.75rem;
  color: #6b7280;
  padding: 8px 12px;
  border-top: 1px solid #f1f5f9;
  display: flex;
  justify-content: space-between;
}
.loader, .error {
  text-align: center;
  padding: 20px;
  color: #6b7280;
}
.error {
  color: #b91c1c;
}
</style>
</head>

<body>

<header>
  <div class="logo">N24.in</div>
</header>

<main>
  <div id="status" class="loader">Loading independent journalismâ€¦</div>
  <div id="feed" class="grid"></div>
</main>

<script>
/* ================= CONFIG ================= */

const PROXY = "https://corsproxy.io/?url=";

const VIDEO_SOURCES = [
  { name: "Ravish Kumar", url: "https://www.youtube.com/feeds/videos.xml?channel_id=UC0yXUUIaPVAqZLgRjvtMftw" },
  { name: "Dhruv Rathee", url: "https://www.youtube.com/feeds/videos.xml?channel_id=UC-CSyyi47VX1lD9zyeABW3w" },
  { name: "Deshbhakt", url: "https://www.youtube.com/feeds/videos.xml?channel_id=UCA4wIY2Z9yE5u6GZV2S9k5A" }
];

/* ================= HELPERS ================= */

function getYouTubeId(url) {
  if (!url) return null;
  const patterns = [
    /v=([^&]+)/,
    /youtu\.be\/([^?]+)/,
    /youtube\.com\/shorts\/([^?]+)/,
    /youtube\.com\/embed\/([^?]+)/
  ];
  for (const p of patterns) {
    const m = url.match(p);
    if (m && m[1]) return m[1];
  }
  return null;
}

async function fetchXML(url) {
  try {
    const r = await fetch(PROXY + encodeURIComponent(url));
    if (!r.ok) throw new Error("HTTP " + r.status);
    const t = await r.text();
    if (!t || t.length < 100) throw new Error("Empty response");
    return t;
  } catch (e) {
    throw new Error("Fetch failed");
  }
}

function parseRSS(xmlText) {
  const xml = new DOMParser().parseFromString(xmlText, "text/xml");
  if (xml.querySelector("parsererror")) {
    throw new Error("Invalid XML");
  }
  return [...xml.querySelectorAll("item")];
}

/* ================= LOAD VIDEOS ================= */

async function loadVideos() {
  const feed = document.getElementById("feed");
  const status = document.getElementById("status");
  let loaded = 0;

  const tasks = VIDEO_SOURCES.map(async src => {
    try {
      const xmlText = await fetchXML(src.url);
      const items = parseRSS(xmlText);

      items.slice(0, 6).forEach(item => {
        const link = item.querySelector("link")?.textContent || "";
        const title = item.querySelector("title")?.textContent || "";

        // ðŸ”´ THIS IS THE KEY FIX (restores previews)
        let thumb =
          item.querySelector("media\\:thumbnail")?.getAttribute("url") ||
          item.querySelector("media\\:content")?.getAttribute("url") ||
          "";

        if (!thumb) {
          const vid = getYouTubeId(link);
          if (vid) {
            thumb = `https://i.ytimg.com/vi/${vid}/hqdefault.jpg`;
          }
        }

        if (!thumb) return;

        const card = document.createElement("article");
        card.className = "card";
        card.innerHTML = `
          <div class="thumb">
            <img loading="lazy" src="${thumb}">
          </div>
          <div class="content">
            <div class="source">ðŸ“º ${src.name}</div>
            <div class="title">
              <a href="${link}" target="_blank">${title}</a>
            </div>
          </div>
          <div class="meta">
            <span>YouTube</span>
            <span><a href="${link}" target="_blank">Open â†—</a></span>
          </div>
        `;
        feed.appendChild(card);
        loaded++;
      });
    } catch (e) {
      console.warn("Video feed failed:", src.name);
    }
  });

  await Promise.allSettled(tasks);

  if (loaded === 0) {
    status.className = "error";
    status.textContent = "Unable to load videos at the moment.";
  } else {
    status.style.display = "none";
  }
}

loadVideos();

</script>
  <!-- Cloudflare Web Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "c5b2b0d87e424dbb9e2235cca1ce9367"}'></script><!-- End Cloudflare Web Analytics -->
<script data-goatcounter="https://n24.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>

</body>
</html>
